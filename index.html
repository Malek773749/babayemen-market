<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù† - Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Ø¬Ù…ÙŠØ¹ Ø£Ù†Ù…Ø§Ø· CSS Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }

        :root {
            --primary: #ff6a00;
            --primary-dark: #e55a00;
            --secondary: #0056b3;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --light: #f8f9fa;
            --dark: #343a40;
            --gray: #6c757d;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        body {
            background: #f5f7fa;
            color: #333;
            direction: rtl;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* ... Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø¬Ù…ÙŠØ¹ Ø£Ù†Ù…Ø§Ø· CSS Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ... */
        /* (Ù„Ø¶ÙŠÙ‚ Ø§Ù„Ù…Ø³Ø§Ø­Ø©ØŒ ØªÙ… Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø£Ù†Ù…Ø§Ø·ØŒ Ù„ÙƒÙ†Ù‡Ø§ Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©) */
        
        .header {
            background: linear-gradient(135deg, var(--primary), #ff8c00);
            color: white;
            padding: 15px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow);
        }
        
        /* ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£Ù†Ù…Ø§Ø· ... */
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="app-container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-store"></i>
                    <span>Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù† - Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø´Ø§Ù…Ù„</span>
                </div>
                
                <div class="search-container">
                    <input type="text" class="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." id="searchInput">
                    <button class="search-btn" id="searchBtn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
                
                <div class="user-actions" id="userActions">
                    <button class="cart-btn" onclick="app.showPage('cart')">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="badge" id="cartBadge">0</span>
                    </button>
                    <button class="btn btn-outline" onclick="app.showPage('profile')" id="profileBtn">
                        <i class="fas fa-user"></i>
                        Ø­Ø³Ø§Ø¨ÙŠ
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <div class="app-container">
        <div class="nav-tabs" id="mainNav">
            <button class="nav-tab active" onclick="app.showPage('home')">
                <i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </button>
            <button class="nav-tab" onclick="app.showPage('products')">
                <i class="fas fa-box"></i> Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
            </button>
            <button class="nav-tab" onclick="app.showPage('cart')">
                <i class="fas fa-shopping-cart"></i> Ø§Ù„Ø³Ù„Ø©
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="app-container">
            <!-- Authentication Page -->
            <div class="page active" id="authPage">
                <div class="auth-container">
                    <h2 style="text-align: center; margin-bottom: 20px;">Ù…Ø±Ø­Ø¨Ø§Ù‹ ÙÙŠ Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù†</h2>
                    <div class="form-group">
                        <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</label>
                        <input type="email" class="form-control" id="loginEmail" placeholder="example@email.com">
                    </div>
                    <div class="form-group">
                        <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                        <input type="password" class="form-control" id="loginPassword" placeholder="********">
                    </div>
                    <button class="btn btn-primary btn-block" onclick="app.login()">
                        <i class="fas fa-sign-in-alt"></i> ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </button>
                    <div style="text-align: center; margin-top: 15px;">
                        <a href="#" onclick="app.showToast('Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹', 'info')">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</a>
                    </div>
                </div>
            </div>

            <!-- Home Page -->
            <div class="page" id="homePage">
                <h2 style="margin-bottom: 20px;">ğŸ›’ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø¨Ø£Ø³Ø¹Ø§Ø± ØµÙ†Ø¹Ø§Ø¡ Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ©</h2>
                <div class="products-grid" id="featuredProducts">
                    <!-- Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø³ØªØ­Ù…Ù„ Ù‡Ù†Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ -->
                </div>
            </div>

            <!-- Products Page -->
            <div class="page" id="productsPage">
                <h2 style="margin-bottom: 20px;">ğŸ“¦ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h2>
                <div class="products-grid" id="allProducts">
                    <!-- Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø³ØªØ­Ù…Ù„ Ù‡Ù†Ø§ -->
                </div>
            </div>

            <!-- Cart Page -->
            <div class="page" id="cartPage">
                <h2 style="margin-bottom: 20px;">ğŸ›’ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚</h2>
                <div class="cart-items" id="cartItems">
                    <!-- Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø³Ù„Ø© -->
                </div>
                <div style="background: white; border-radius: var(--radius); padding: 25px; margin-top: 20px; box-shadow: var(--shadow);">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <span style="font-weight: 600;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</span>
                        <span style="font-size: 24px; font-weight: 700; color: var(--primary);" id="cartTotal">0 Ø±.ÙŠ</span>
                    </div>
                    <button class="btn btn-primary btn-block" onclick="app.showCheckoutModal()">
                        <i class="fas fa-credit-card"></i> Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Checkout Modal -->
    <div class="modal" id="checkoutModal">
        <div class="modal-content">
            <h3>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡</h3>
            <div class="form-group">
                <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
                <textarea class="form-control" id="shippingAddress" rows="3" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙˆØµÙŠÙ„ ÙÙŠ ØµÙ†Ø¹Ø§Ø¡"></textarea>
            </div>
            <button class="btn btn-success btn-block" onclick="app.placeOrder()">
                <i class="fas fa-check"></i> ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨
            </button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script>
        // ============== ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù† Ø§Ù„ÙƒØ§Ù…Ù„ ==============
        class BabaYemenApp {
            constructor() {
                this.currentUser = null;
                this.cart = [];
                this.products = [];
                this.orders = [];
                this.users = [];
                this.init();
            }
            
            init() {
                this.loadData();
                this.setupEventListeners();
                this.checkAuth();
            }
            
            loadData() {
                this.users = JSON.parse(localStorage.getItem('babayemen_users')) || [];
                this.products = JSON.parse(localStorage.getItem('babayemen_products')) || this.getDefaultProducts();
                this.orders = JSON.parse(localStorage.getItem('babayemen_orders')) || [];
                this.cart = JSON.parse(localStorage.getItem('babayemen_cart')) || [];
            }
            
            // ============== Ø§Ù„Ø£Ø³Ø¹Ø§Ø± Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠØ© Ù„Ø³ÙˆÙ‚ ØµÙ†Ø¹Ø§Ø¡ ==============
            getDefaultProducts() {
                return [
                    {
                        id: 1,
                        name: 'Ù‡Ø§ØªÙ Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬ A14',
                        description: 'Ù‡Ø§ØªÙ Ø°ÙƒÙŠ 4GØŒ Ø´Ø§Ø´Ø© 6.6 Ø¨ÙˆØµØ©ØŒ ÙƒØ§Ù…ÙŠØ±Ø§ Ø«Ù„Ø§Ø«ÙŠØ© 50 Ù…ÙŠØ¬Ø§Ø¨ÙƒØ³Ù„ØŒ Ø°Ø§ÙƒØ±Ø© 128GB',
                        price: 80000, // Ø³Ø¹Ø± ÙˆØ§Ù‚Ø¹ÙŠ Ù…Ø¹Ø¯Ù„ Ù…Ù† 185,000
                        oldPrice: 95000,
                        image: 'https://images.unsplash.com/photo-1598327105666-5b89351aff97?w=400&h=400&fit=crop',
                        category: 'electronics',
                        sellerId: 'seller1',
                        rating: 4.3,
                        stock: 15,
                        status: 'sale',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        name: 'Ø£Ø³Ù…Ù†Øª ÙŠÙ…Ù†ÙŠ 50 ÙƒØ¬Ù…',
                        description: 'Ø£Ø³Ù…Ù†Øª Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù„Ù„Ø¨Ù†Ø§Ø¡ØŒ Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„Ø¹ÙˆØ§Ù…Ù„ Ø§Ù„Ø¬ÙˆÙŠØ©',
                        price: 4000, // Ø§Ù„Ø³Ø¹Ø± Ø§Ù„ÙˆØ§Ù‚Ø¹ÙŠ Ø§Ù„Ø°ÙŠ Ø°ÙƒØ±ØªÙ‡
                        image: 'https://images.unsplash.com/photo-1600596542815-ffad4c1539a9?w=400&h=400&fit=crop',
                        category: 'construction',
                        sellerId: 'seller2',
                        rating: 4.2,
                        stock: 500,
                        status: 'best',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        name: 'Ø£Ø±Ø² Ø¨Ø³Ù…ØªÙŠ Ù‡Ù†Ø¯ÙŠ 5 ÙƒØ¬Ù…',
                        description: 'Ø£Ø±Ø² Ù‡Ù†Ø¯ÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ Ø­Ø¨Ø© Ø·ÙˆÙŠÙ„Ø©',
                        price: 9000,
                        oldPrice: 8500,
                        image: 'https://images.unsplash.com/photo-1586201375761-83865001e31c?w=400&h=400&fit=crop',
                        category: 'food',
                        sellerId: 'seller3',
                        rating: 4.7,
                        stock: 200,
                        status: 'sale',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 4,
                        name: 'Ù‚Ù…ÙŠØµ Ø±Ø¬Ø§Ù„ÙŠ Ù‚Ø·Ù†ÙŠ',
                        description: 'Ù‚Ù…ÙŠØµ Ù‚Ø·Ù†ÙŠ Ø£Ù†ÙŠÙ‚ØŒ Ù…Ù†Ø§Ø³Ø¨ Ù„Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª ÙˆØ§Ù„Ø¹Ù…Ù„',
                        price: 18000,
                        image: 'https://images.unsplash.com/photo-1596755094514-f87e34085b2c?w=400&h=400&fit=crop',
                        category: 'clothing',
                        sellerId: 'seller4',
                        rating: 4.3,
                        stock: 50,
                        status: 'new',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 5,
                        name: 'Ù„Ø§Ø¨ØªÙˆØ¨ Ù„ÙŠÙ†ÙˆÙÙˆ Ø§ÙŠØ¯Ø¬Ø§Ø¨Ø§Ø¯',
                        description: 'Ù…Ø¹Ø§Ù„Ø¬ Intel i5ØŒ Ø°Ø§ÙƒØ±Ø© 8GBØŒ ØªØ®Ø²ÙŠÙ† 512GB SSD',
                        price: 450000, // Ù…Ø¹Ø¯Ù„ Ù…Ù† 650,000
                        oldPrice: 500000,
                        image: 'https://images.unsplash.com/photo-1496181133206-80ce9b88a853?w=400&h=400&fit=crop',
                        category: 'electronics',
                        sellerId: 'seller1',
                        rating: 4.6,
                        stock: 8,
                        status: 'sale',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 6,
                        name: 'Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­ 12 Ù…Ù…',
                        description: 'Ø­Ø¯ÙŠØ¯ ØªØ³Ù„ÙŠØ­ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ù„Ù„Ø¨Ù†Ø§Ø¡ØŒ Ù…Ù‚Ø§ÙˆÙ… Ù„Ù„ØµØ¯Ø£',
                        price: 7500,
                        image: 'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=400&h=400&fit=crop',
                        category: 'construction',
                        sellerId: 'seller2',
                        rating: 4.4,
                        stock: 1000,
                        status: 'best',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 7,
                        name: 'Ø³ÙƒØ± Ø£Ø¨ÙŠØ¶ 5 ÙƒØ¬Ù…',
                        description: 'Ø³ÙƒØ± Ø£Ø¨ÙŠØ¶ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ Ù†Ù‚ÙŠ 100%',
                        price: 2800, // Ø§Ù„ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ù‡Ù… Ù…Ù† 6,500
                        oldPrice: 3200,
                        image: 'https://images.unsplash.com/photo-1622484202383-7aacd50a5b5a?w=400&h=400&fit=crop',
                        category: 'food',
                        sellerId: 'seller3',
                        rating: 4.5,
                        stock: 300,
                        status: 'sale',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 8,
                        name: 'Ø·Ø§Ø¨Ø¹Ø© HP Ù„ÙŠØ²Ø±',
                        description: 'Ø·Ø§Ø¨Ø¹Ø© Ù„ÙŠØ²Ø± Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¬ÙˆØ¯Ø©ØŒ Ø·Ø¨Ø§Ø¹Ø© Ø³Ø±ÙŠØ¹Ø©',
                        price: 180000, // Ù…Ø¹Ø¯Ù„ Ù…Ù† 285,000
                        oldPrice: 200000,
                        image: 'https://images.unsplash.com/photo-1496171367470-9ed9a91ea931?w=400&h=400&fit=crop',
                        category: 'electronics',
                        sellerId: 'seller1',
                        rating: 4.4,
                        stock: 12,
                        status: 'sale',
                        createdAt: new Date().toISOString()
                    }
                ];
            }
            
            // ============== Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ==============
            checkAuth() {
                const savedUser = localStorage.getItem('babayemen_currentUser');
                if (savedUser) {
                    this.currentUser = JSON.parse(savedUser);
                    this.showApp();
                } else {
                    this.showAuth();
                }
            }
            
            showAuth() {
                this.showPage('auth');
                document.getElementById('mainNav').style.display = 'none';
                document.getElementById('userActions').style.display = 'none';
            }
            
            showApp() {
                this.showPage('home');
                document.getElementById('mainNav').style.display = 'flex';
                document.getElementById('userActions').style.display = 'flex';
                document.getElementById('profileBtn').innerHTML = `<i class="fas fa-user"></i> ${this.currentUser.name}`;
                this.loadFeaturedProducts();
            }
            
            login() {
                const email = document.getElementById('loginEmail').value;
                const password = document.getElementById('loginPassword').value;
                
                // Ù…Ø³ØªØ®Ø¯Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„ØªØ¬Ø±Ø¨Ø©
                if (email && password) {
                    this.currentUser = {
                        id: 'user_001',
                        name: 'Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù†',
                        email: email,
                        wallet: 100000
                    };
                    localStorage.setItem('babayemen_currentUser', JSON.stringify(this.currentUser));
                    this.showToast('Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù†!', 'success');
                    this.showApp();
                } else {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'error');
                }
            }
            
            // ============== Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙØ­Ø§Øª ==============
            showPage(pageId) {
                document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
                document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
                
                const page = document.getElementById(pageId + 'Page');
                if (page) {
                    page.classList.add('active');
                    this.currentPage = pageId;
                    
                    const tab = document.querySelector(`.nav-tab[onclick*="${pageId}"]`);
                    if (tab) tab.classList.add('active');
                    
                    this.loadPageContent(pageId);
                }
            }
            
            loadPageContent(pageId) {
                switch(pageId) {
                    case 'home':
                        this.loadFeaturedProducts();
                        break;
                    case 'products':
                        this.loadAllProducts();
                        break;
                    case 'cart':
                        this.loadCart();
                        break;
                }
            }
            
            // ============== Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ==============
            loadFeaturedProducts() {
                const container = document.getElementById('featuredProducts');
                if (!container) return;
                
                const featured = this.products.slice(0, 4);
                container.innerHTML = this.renderProducts(featured);
            }
            
            loadAllProducts() {
                const container = document.getElementById('allProducts');
                if (!container) return;
                
                container.innerHTML = this.renderProducts(this.products);
            }
            
            renderProducts(products) {
                return products.map(product => {
                    const discount = product.oldPrice ? 
                        Math.round(((product.oldPrice - product.price) / product.oldPrice) * 100) : 0;
                    
                    return `
                        <div class="product-card">
                            ${product.status === 'sale' ? 
                                `<div class="product-status status-sale">Ø¹Ø±Ø¶ Ø®Ø§Øµ</div>` : 
                                product.status === 'new' ? 
                                `<div class="product-status status-new">Ø¬Ø¯ÙŠØ¯</div>` : ''}
                            <img src="${product.image}" alt="${product.name}" class="product-image">
                            <div class="product-info">
                                <h3 class="product-title">${product.name}</h3>
                                <p style="color: var(--gray); font-size: 14px; margin: 5px 0;">
                                    ${product.description.substring(0, 50)}...
                                </p>
                                <div style="display: flex; align-items: center;">
                                    <div class="product-price">${this.formatPrice(product.price)} Ø±.ÙŠ</div>
                                    ${product.oldPrice ? `
                                        <div class="product-old-price">${this.formatPrice(product.oldPrice)} Ø±.ÙŠ</div>
                                    ` : ''}
                                </div>
                                <div class="product-actions">
                                    <button class="btn btn-primary btn-small" onclick="app.addToCart(${product.id})">
                                        <i class="fas fa-cart-plus"></i> Ø£Ø¶Ù Ù„Ù„Ø³Ù„Ø©
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            // ============== Ù†Ø¸Ø§Ù… Ø§Ù„Ø³Ù„Ø© ==============
            addToCart(productId) {
                const product = this.products.find(p => p.id === productId);
                if (!product) return;
                
                const existingItem = this.cart.find(item => item.productId === productId);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    this.cart.push({
                        productId,
                        name: product.name,
                        price: product.price,
                        image: product.image,
                        quantity: 1
                    });
                }
                
                localStorage.setItem('babayemen_cart', JSON.stringify(this.cart));
                this.updateCartBadge();
                this.showToast('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©', 'success');
            }
            
            loadCart() {
                const container = document.getElementById('cartItems');
                const totalElement = document.getElementById('cartTotal');
                
                if (!container) return;
                
                if (this.cart.length === 0) {
                    container.innerHTML = `
                        <div style="text-align: center; padding: 40px;">
                            <i class="fas fa-shopping-cart" style="font-size: 60px; color: #ddd;"></i>
                            <h3>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ÙØ§Ø±ØºØ©</h3>
                        </div>
                    `;
                    totalElement.textContent = '0 Ø±.ÙŠ';
                    return;
                }
                
                let total = 0;
                container.innerHTML = this.cart.map((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    
                    return `
                        <div class="cart-item">
                            <img src="${item.image}" alt="${item.name}" class="cart-item-image">
                            <div class="cart-item-details">
                                <h3 class="cart-item-title">${item.name}</h3>
                                <div class="cart-item-price">${this.formatPrice(item.price)} Ø±.ÙŠ</div>
                                <div class="cart-quantity">
                                    <button class="quantity-btn" onclick="app.updateQuantity(${index}, -1)">-</button>
                                    <input type="number" class="quantity-input" value="${item.quantity}" 
                                           min="1" onchange="app.changeQuantity(${index}, this.value)">
                                    <button class="quantity-btn" onclick="app.updateQuantity(${index}, 1)">+</button>
                                    <button class="btn btn-danger btn-small" onclick="app.removeFromCart(${index})">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                totalElement.textContent = `${this.formatPrice(total)} Ø±.ÙŠ`;
            }
            
            updateQuantity(index, change) {
                const newQuantity = this.cart[index].quantity + change;
                if (newQuantity < 1) {
                    this.removeFromCart(index);
                    return;
                }
                
                this.cart[index].quantity = newQuantity;
                localStorage.setItem('babayemen_cart', JSON.stringify(this.cart));
                this.loadCart();
                this.updateCartBadge();
            }
            
            removeFromCart(index) {
                this.cart.splice(index, 1);
                localStorage.setItem('babayemen_cart', JSON.stringify(this.cart));
                this.loadCart();
                this.updateCartBadge();
                this.showToast('ØªÙ…Øª Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù…Ù†ØªØ¬', 'success');
            }
            
            updateCartBadge() {
                const totalItems = this.cart.reduce((sum, item) => sum + item.quantity, 0);
                document.getElementById('cartBadge').textContent = totalItems;
                document.getElementById('cartBadge').style.display = totalItems > 0 ? 'block' : 'none';
            }
            
            // ============== Ù†Ø¸Ø§Ù… Ø§Ù„Ø·Ù„Ø¨Ø§Øª ==============
            showCheckoutModal() {
                if (this.cart.length === 0) {
                    this.showToast('Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ÙØ§Ø±ØºØ©', 'error');
                    return;
                }
                
                document.getElementById('checkoutModal').classList.add('active');
            }
            
            placeOrder() {
                const address = document.getElementById('shippingAddress').value;
                if (!address) {
                    this.showToast('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªÙˆØµÙŠÙ„', 'error');
                    return;
                }
                
                const total = this.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                
                const order = {
                    id: 'ORD_' + Date.now(),
                    items: [...this.cart],
                    total,
                    shippingAddress: address,
                    status: 'pending',
                    createdAt: new Date().toISOString()
                };
                
                this.orders.push(order);
                localStorage.setItem('babayemen_orders', JSON.stringify(this.orders));
                
                this.cart = [];
                localStorage.setItem('babayemen_cart', JSON.stringify(this.cart));
                
                document.getElementById('checkoutModal').classList.remove('active');
                this.updateCartBadge();
                this.showToast('ØªÙ… ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                this.showPage('home');
            }
            
            // ============== Ø£Ø¯ÙˆØ§Øª Ù…Ø³Ø§Ø¹Ø¯Ø© ==============
            formatPrice(price) {
                return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            }
            
            showToast(message, type = 'info') {
                Toastify({
                    text: message,
                    duration: 3000,
                    gravity: "top",
                    position: "right",
                    backgroundColor: type === 'error' ? '#dc3545' : 
                                   type === 'success' ? '#28a745' : 
                                   type === 'warning' ? '#ffc107' : '#17a2b8',
                    stopOnFocus: true
                }).showToast();
            }
            
            setupEventListeners() {
                document.getElementById('searchBtn').addEventListener('click', () => this.searchProducts());
                document.getElementById('searchInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') this.searchProducts();
                });
            }
            
            searchProducts() {
                const query = document.getElementById('searchInput').value.toLowerCase();
                this.showPage('products');
                
                const filtered = this.products.filter(p => 
                    p.name.toLowerCase().includes(query) || 
                    p.description.toLowerCase().includes(query)
                );
                
                document.getElementById('allProducts').innerHTML = filtered.length > 0 
                    ? this.renderProducts(filtered)
                    : '<div style="text-align: center; padding: 40px; grid-column: 1/-1;"><h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ØªØ·Ø§Ø¨Ù‚ Ø¨Ø­Ø«Ùƒ</h3></div>';
            }
        }

        // ============== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ==============
        let app;
        
        document.addEventListener('DOMContentLoaded', () => {
            app = new BabaYemenApp();
            window.app = app;
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªØ®Ø¯Ù… Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±
            if (!localStorage.getItem('babayemen_users')) {
                localStorage.setItem('babayemen_users', JSON.stringify([{
                    id: 'user_001',
                    name: 'Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ø¨Ø§ Ø§Ù„ÙŠÙ…Ù†',
                    email: 'test@yemen.com',
                    password: '123456',
                    wallet: 100000
                }]));
            }
        });
    </script>
</body>
</html>
